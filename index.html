<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Validator Checker</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="abi.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: auto; }
    input, button { padding: 10px; margin: 10px 0; width: 100%; }
    .result { margin-top: 20px; background: #f0f0f0; padding: 15px; border-radius: 8px; }
    h1 { font-size: 22px; margin-bottom: 15px; }
  </style>
</head>
<body>
  <h1>🔎 Validator Info Checker (Sepolia)</h1>
  <input type="text" id="validatorAddress" placeholder="Paste validator address here..." />
  <button onclick="checkValidator()">Check Validator Info</button>
  
  <div class="result" id="result"></div>

  <script>
    const contractAddress = '0xeE6d4e937f0493Fb461F28A75Cf591f1dBa8704E';

    // Ganti provider ke node Sepolia pribadi
    const provider = new ethers.providers.JsonRpcProvider('http://83.171.249.10:8545/');

    const contract = new ethers.Contract(contractAddress, validatorAbi, provider);

    async function checkValidator() {
      const address = document.getElementById('validatorAddress').value.trim();
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '⏳ Loading...';

      try {
        const attesters = await contract.getAttesters();
        const found = attesters.map(a => a.toLowerCase()).includes(address.toLowerCase());

        let output = `<strong>📋 BASIC INFO</strong><br>`;
        output += `🔑 Address: ${address}<br>`;
        output += `🟢 Registered Validator: ${found ? '✅ Yes' : '❌ No'}<br>`;

        if (found) {
          const owner = await contract.owner();
          const burnAddress = await contract.getBurnAddress();
          const version = await contract.getVersion();
          const genesis = await contract.getGenesisTime();
          const epochDuration = await contract.getEpochDuration();

          output += `<br><strong>🌐 CONTRACT INFO</strong><br>`;
          output += `🧾 Version: ${version}<br>`;
          output += `🔥 Burn Address: ${burnAddress}<br>`;
          output += `👑 Owner: ${owner}<br>`;
          output += `🕒 Genesis Time: ${genesis}<br>`;
          output += `⏳ Epoch Duration: ${epochDuration}<br>`;
        }

        resultDiv.innerHTML = output;
      } catch (err) {
        resultDiv.innerHTML = `❌ Error: ${err.message}`;
      }
    }
  </script>
</body>
</html>
